import streamlit as st
import pandas as pd
import pickle

# Ø¹Ù†ÙˆØ§Ù† Ø§Ù¾
st.title("ğŸ”¬ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø³Ù† Ø§Ù¾ÛŒâ€ŒÚ˜Ù†ØªÛŒÚ©ÛŒ")

# Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„
uploaded_file = st.file_uploader("ğŸ“‚ ÙØ§ÛŒÙ„ CSV Ù…ØªÛŒÙ„Ø§Ø³ÛŒÙˆÙ† Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯", type=["csv"])

# Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¯Ù„
@st.cache_resource
def load_model():
    with open("trained_model.pkl", "rb") as f:
        return pickle.load(f)

model = load_model()

# ÙˆÙ‚ØªÛŒ ÙØ§ÛŒÙ„ Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯:
if uploaded_file is not None:
    try:
        df = pd.read_csv(uploaded_file)
        st.write("ğŸ” Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:", df.head())

        # Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ
        predictions = model.predict(df)
        df["Predicted_Age"] = predictions

        st.success("âœ… Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!")
        st.write(df[["Predicted_Age"]])

        # Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®Ø±ÙˆØ¬ÛŒ
        csv = df.to_csv(index=False).encode("utf-8")
        st.download_button("ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø®Ø±ÙˆØ¬ÛŒ", data=csv, file_name="predicted_ages.csv", mime="text/csv")

    except Exception as e:
        st.error(f"âŒ Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ ÙØ§ÛŒÙ„: {e}")
